# PR-13 Mandate — Truncation UX

## Objective
Expose clear **user-facing signals** when recurrence expansions are truncated due to system limits (500 per series, 10,000 per query).  
Prevent silent data loss by providing banners or badges that inform the user of truncation in an accessible and unobtrusive way.

---

## Scope
- **UI Changes:**
  - Add a banner component (`TruncationBanner`) in shared UI primitives (`/src/ui/`).
  - Banner text: *“This list was shortened to the first {N} results.”*
  - Banner displayed above the affected list (calendar, notes, files, etc.) only when `truncated: true` is present in API response.
- **Accessibility:**
  - Banner must have `role="status"` or `aria-live="polite"` so screen readers announce it when displayed.
  - Must be dismissible via a keyboard-accessible “Close” button.
- **IPC Integration:**
  - Ensure API responses from `events_list_range` (and any other recurrence endpoint) include `truncated: true|false` field (already introduced in PR-8).
- **Visual Design:**
  - Use existing alert style tokens (info severity).
  - Banner aligned full-width at top of list content.
- **Documentation:**
  - Add section in `/docs/recurrence-limits.md` explaining truncation UX, banner copy, and accessibility notes.

---

## Non-Goals
- No redesign of broader notification/toast system.  
- No user preferences for hiding truncation messages.  
- No changes to underlying recurrence expansion logic (handled by PR-8).  

---

## Acceptance Criteria
1. **Banner Component:** New `TruncationBanner` primitive exists, styled consistently with other alert banners.  
2. **Conditional Display:** Banner only appears when `truncated: true` in payload.  
3. **Accurate Copy:** Banner shows correct result count (500 or 10,000 depending on which limit hit).  
4. **Accessibility:** Screen readers announce the banner; keyboard navigation can focus and dismiss.  
5. **Dismissal State:** Once dismissed, banner does not reappear until next API fetch with truncation flag.  
6. **Tests:** Unit tests ensure banner renders only when `truncated: true`. Integration tests verify it appears in Calendar/Notes views when expansion exceeds limits.  
7. **Documentation:** `/docs/recurrence-limits.md` updated with screenshot and UX notes.  

---

## Evidence Required in PR
- **UI Screenshot:** Banner displayed above Calendar list with sample truncation.  
- **Accessibility Proof:** Test log from automated a11y checker showing role and aria attributes.  
- **Conditional Proof:** Test run with 200 events (no banner) vs 600 events (banner visible).  
- **Dismissal Proof:** Screen capture showing user dismissing banner and it staying gone until reload.  
- **Doc Proof:** Updated `/docs/recurrence-limits.md` with banner details.  

---

## Rollback Plan
- Remove `TruncationBanner` component.  
- Remove conditional rendering logic in Calendar/Notes views.  
- Delete UX documentation in `recurrence-limits.md`.  
- Leaves truncation silently applied without user-facing signals.  

---

## PR Title / Description
- **Title:** `feat(recurrence-ux): add truncation banner for recurrence limits`  
- **Body:** Must include Objective, Scope, Non-Goals, Acceptance Criteria, Evidence, and Rollback.

---
```
