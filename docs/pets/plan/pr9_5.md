# PR9.5 – Pet Image Field & Vault Integration

## Objective
Introduce a nullable `image_path` column for pets, wire it through IPC/repository layers, and extend vault tooling so pet profile photos follow the same sanitisation, repair, and export rules as existing attachments.

## Deliverables
- Schema migration `0028_pets_image_path` with matching down script and schema snapshots.
- Backend model/IPC updates exposing `image_path` in Rust and TypeScript bindings.
- Vault enforcement for the new `pet_image` category, including move, repair, and export coverage.
- Repository helper `petsUpdateImage` for renderer flows.
- Unit tests covering pet image guard behaviour and vault rejection cases.

## Evidence
- Migration: `migrations/0028_pets_image_path.up.sql`, schema snapshots updated.【F:migrations/0028_pets_image_path.up.sql†L1-L2】【F:schema.sql†L210-L221】
- IPC/contracts: `src/lib/ipc/contracts/pets.ts`, `src/repos.ts` additions.【F:src/lib/ipc/contracts/pets.ts†L31-L109】【F:src/repos.ts†L71-L141】
- Vault support: `src-tauri/src/lib.rs`, `src-tauri/src/file_ops.rs`, `src-tauri/src/export/mod.rs` updates.【F:src-tauri/src/lib.rs†L3380-L3719】【F:src-tauri/src/file_ops.rs†L200-L420】【F:src-tauri/src/export/mod.rs†L360-L420】
- Tests: `pet_image_guard_tests` module exercising guard logic.【F:src-tauri/src/lib.rs†L5661-L5735】
- Documentation: `docs/pets/database.md`, `docs/pets/ipc.md`, `docs/pets/references.md`, `docs/pets/plan/checklist.md`.

## UI Rollout
- Card grid replaces the legacy list, matching Family card affordances and keyboard focus states.
- Species-specific placeholders ship under `src/assets/pets/placeholders/` with lazy-loaded photos and reveal actions.
- Per-card “Change photo” picker imports the chosen file into the vault, sanitises its name, and patches only the affected DOM node.
- Snapshot, DOM patching, and change-photo flow tests cover the renderer behaviour.

## Status
✅ Backend foundation landed (PR9.5a) and UI parity shipped in PR9.5b.
